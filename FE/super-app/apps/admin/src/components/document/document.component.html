<ae-crud (import)="triggerFileInput()">
  <!-- Custom toolbar with import progress -->
  <ng-container toolbar>
    <div class="flex align-items-center gap-2">
      <p-button label="Tải template" icon="pi pi-download" severity="secondary" size="small"
        (onClick)="downloadTemplate()"></p-button>

      @if (importing()) {
      <div class="import-progress flex align-items-center gap-2">
        <p-progressBar [value]="importProgress()" [showValue]="false" styleClass="w-20rem"></p-progressBar>
        <span class="text-sm">{{ importMessage() }}</span>
      </div>
      }
    </div>
  </ng-container>
</ae-crud>

<!-- Toast notifications -->
<p-toast></p-toast>
<!-- File view dialog -->
@if (showFileViewDialog){
<p-dialog [(visible)]="showFileViewDialog" [modal]="true" [style]="{ width: '100%', height: '100%' }"
  [focusOnShow]="false">
  <ng-template #header>
    <div>Sửa bản ghi</div>
  </ng-template>
  <div class="flex flex-row h-full">
    <div class="flex-1">
      <ae-scrollbar>
        <app-pdf-viewer [document]="selectedDocument">
        </app-pdf-viewer>
      </ae-scrollbar>
    </div>
    @if (selectedDocument)
    {
    <div style="width: 30%">
      <p-tabs value="0" style="height: 100%; overflow: hidden">
        <p-tablist>
          <p-tab value="0">Chi tiết</p-tab>
          <p-tab value="1">Cùng bộ hồ sơ</p-tab>
        </p-tablist>
        <p-tabpanels style="height: 100%; overflow: hidden">
          <p-tabpanel value="0">
            <ae-scrollbar>
              <ae-form [schemas]="settings.schemas" [data]="selectedDocument">
              </ae-form>
            </ae-scrollbar>
          </p-tabpanel>
          <p-tabpanel value="1">
            <ae-scrollbar>
              <ae-list [columns]="vanBanLienQuanSettings().schemas" [listData]="vanBanLienQuan()"
                [settings]="vanBanLienQuanSettings()" [pageSize]="-1" [loading]="false" [offline]="true"
                (execute)="handleVBLQListEvent($event)"></ae-list>
            </ae-scrollbar>
          </p-tabpanel>
        </p-tabpanels>
      </p-tabs>
    </div>
    }
  </div>
  <ng-template #footer>
    <p-button label="Cancel" icon="pi pi-times" [text]="true" variant="text" severity="secondary"
      (onClick)="showFileViewDialog = false" />
    <p-button label="Save" icon="pi pi-check" [text]="true" [autofocus]="false" severity="success"
      (onClick)="saveData()" />
  </ng-template>
</p-dialog>
}